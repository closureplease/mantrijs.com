<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><title>SourceMaps on Mantri - Mantri: Javascript Dependency System</title><link rel="stylesheet" href="/css/main.css"><link href="http://fonts.googleapis.com/css?family=Wendy+One" rel="stylesheet" type="text/css"><link rel="shortcut icon" href="/img/favicon.ico" type="image/x-icon"><!-- link(href='/rss', rel='alternate', title='Grunt Blog Feed', type='application/atom+xml')--><script src="/js/vendor/lib/modernizr.min.js"></script></head><body class="page-api page-secondary"><div class="navbar navbar-inverse"><div class="navbar-inner"><div class="container"><a href="/" class="brand"><span class="logo">Mantri</span></a><div class="nav-collapse collapse"><ul class="nav"><li><a href="/getting-started/"><i class="icon-arrow-right"></i><span>Getting Started</span></a></li><li><a href="/api"><i class="icon-cog"></i><span>API</span></a></li></ul><form class="navbar-search pull-right"><input type="text" placeholder="Search" class="search-query"></form></div><!--.nav-collapse--></div></div></div><div class="content"><div class="container sourcemaps-on-mantri"><div class="row-fluid"><div class="span9 page"><div class="hero-unit"><h1>SourceMaps on Mantri</h1><p>Mantri generates <a href="https://docs.google.com/document/d/1U1RGAehQwRypUTovF1KRlpiOFze0b-_2gc6fAH0KY0k">Source Map v3</a> files.</p>
<p>To enable sourceMap file generation you only need to define the <code>sourceMapFile</code> key in the build options of your mantriConf.json file.</p>
<p>A <code>mantriConf.json</code> file with sourceMaps enabled:</p>
<pre><code class="lang-json">{
  <span class="string">"baseUrl"</span>: <span class="string">"js/"</span>,

  <span class="string">"build"</span>: {
    <span class="string">"src"</span>: <span class="string">"js/app.js"</span>,
    <span class="string">"dest"</span>: <span class="string">"dist/app.min.js"</span>,
    <span class="string">"sourceMapFile"</span>: <span class="string">"dist/app.min.js.map"</span>,
    <span class="string">"sourceMappingURL"</span>: <span class="string">"/dist/app.min.js.map"</span>
  }
}</code></pre>
<p>The <code>sourceMappingURL</code> key is optional, if defined it will point your browser to the value you define.</p>
<h2><a class="anchor" href="#common-gotchas" name="common-gotchas">Common Gotchas</a></h2>
<h3><a class="anchor" href="#source-file-paths" name="source-file-paths">Source file paths</a></h3>
<p>The sourceMap file is generated by the <a href="https://code.google.com/p/closure-compiler">Google Closure Compiler (GCC)</a>. GCC <a href="https://code.google.com/p/closure-compiler/issues/detail?id=770">does not -yet- provide a way</a> to mangle with the paths in the <code>sources</code> key of the sourceMap file. As a result the mappings will not work.</p>
<p>Suppose your Javascript application is under the folder <code>js/</code> and the build output and sourceMap file is in the folder <code>dist/</code>. The generated sourceMap <code>sources</code> key will look like this:</p>
<pre><code class="lang-json">{
  <span class="string">"version"</span>:<span class="number">3</span>,
  <span class="string">"file"</span>:<span class="string">"dist/app.min.js"</span>,
  <span class="string">"lineCount"</span>:<span class="number">561</span>,
  <span class="string">"mappings"</span>:<span class="string">"KAFJ,CAAR;"</span>,
  <span class="string">"names"</span>:[<span class="string">"a"</span>,<span class="string">"b"</span>],
  <span class="string">"sources"</span>:[
    <span class="string">"js/vendor/jquery.min.js"</span>,
    <span class="string">"js/vendor/handlebars.min.js"</span>,
    <span class="string">"js/app.js"</span>
  ]
}</code></pre>
<p>As the paths are relative and the sourceMap file was accessed from the <code>/dist/app.min.map</code> location, your browser will be directed to look into <code>/dist/js/app.js</code> instead of <code>/js/app.js</code>.</p>
<p>Right now, there are three solutions to this problem, the following one:</p>
<h4><a class="anchor" href="#the-symbolic-link-of-shame" name="the-symbolic-link-of-shame">The symbolic-link of shame</a></h4>
<p>The quick and dirty solution would be to create a symbolink link in your <code>dist/</code> folder pointing to the <code>js/</code> folder.</p>
<h4><a class="anchor" href="#waiting-on-the-other-solutions" name="waiting-on-the-other-solutions">Waiting on the other solutions</a></h4>
<p>The other two possible solutions is to either implement a post-processor that will manipulate the generated sourceMap file (<a href="https://github.com/closureplease/mantri/issues/14">PRs welcome!</a>), or waiting for the ultimate solution of <a href="https://code.google.com/p/closure-compiler/issues/detail?id=770">GCC implementing the <code>sourceRoot</code> option</a>.</p>
</div></div><div class="span3"><div class="well sidebar-nav"><ul class="nav nav-list"><li class="nav-header"><span>Web API</span></li><li><a href="/api/the-script-element">The Script Element</a></li><li><a href="/api/goog-provide-and-require">goog provide and require</a></li></ul><ul class="nav nav-list"><li class="nav-header"><span>Building</span></li><li><a href="/api/the-configuration-file">The Configuration File</a></li><li><a href="/api/building-multiple-modules">Building Multiple Modules</a></li><li><a href="/api/sourcemaps-on-mantri" class="active">SourceMaps on Mantri</a></li><li><a href="/api/the-cli">The CLI</a></li><li><a href="/api/migrating-from-0.1.x-to-0.2.x">Migrating from 0.1.x to 0.2.x</a></li></ul><ul class="nav nav-list"><li class="nav-header"><span>Grunt Tasks</span></li><li><a href="/api/mantri-as-a-grunt-plugin">Mantri As a Grunt Plugin</a></li><li><a href="/api/grunt-task-mantrideps">Grunt Task mantriDeps</a></li><li><a href="/api/grunt-task-mantribuild">Grunt Task mantriBuild</a></li></ul></div></div></div></div></div><footer class="master-footer"><div class="inner"><div class="container"><ul class="pull-right"><li class="social"><iframe src="http://ghbtns.com/github-btn.html?user=thanpolas&amp;repo=mantri&amp;type=watch&amp;count=true" allowtransparency="true" frameborder="0" scrolling="0" width="94" height="20"></iframe><iframe url="http://mantrijs.com" text="zit" allowtransparency="true" frameborder="0" scrolling="no" src="https://platform.twitter.com/widgets/tweet_button.html?url=http%3A%2F%2Fmantrijs.com&amp;text=Check%20out%20Mantri%2C%20Javascript%20Dependency%20System%20extraordinaire&amp;hashtags=mantrijs" style="width:130px; height:20px;"></iframe><!--a(href='https://github.com/thanpolas/mantri', alt='Mantri on GitHub')--><!--span Mantri on GitHub &nbsp;--><!--span.icon-github--></li></ul><ul class="pull-left"><li>This site was built using the <a href="https://github.com/gruntjs/gruntjs.com/tree/site-0.4.0" alt="gruntjs.com repository">source, images and copy</a> of <a href="http://gruntjs.com" alt="grunt">gruntjs.com</a></li><li>The rest (c) 2013 <a href="http://thanpol.as" alt="Thanasis Polychronakis Website">Thanasis Polychronakis</a> Licensed under the <a href="https://github.com/thanpolas/mantri/blob/master/LICENSE-MIT" alt="MIT LICENSE">MIT</a>.</li></ul></div></div></footer><script>var LIVE = !!window.location.origin.match(/mantrijs/);

(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', (LIVE ? 'UA-16398858-9' : 'xxxx'), 'mantrijs.com');
ga('send', 'pageview');</script></body></html>